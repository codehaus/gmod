import java.awt.*
import java.awt.geom.*
import javax.swing.*
//import org.jdesktop.swingx.geom.*
import groovy.swing.SwingBuilder
import groovy.swing.j2d.*

def gb = new GraphicsBuilder()
def helpers = ["Jdk6GraphicsBuilderHelper",
               "SwingXGraphicsBuilderHelper",
               "BatikGraphicsBuilderHelper"]
helpers.each { helper ->
   try{
      Class helperClass = Class.forName("groovy.swing.j2d.\${helper}")
      helperClass.registerOperations( gb )
   }catch( Exception e ){
      System.err.println("Couldn't register \${helper}")
   }
}

def graphicsOperation = gb.group {
   ${source}
}

def swing = SwingBuilder.build {
   frame( id: 'frame', title: '${title}', size: [600,480], locationRelativeTo: null ){
      panel( new GraphicsPanel(), graphicsOperation: graphicsOperation )
   }
}

swing.doLater { frame.visible = true }